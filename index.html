<!DOCTYPE html>
<html>
  <head>
    <title>Stanzify</title>
  </head>
  <body>
    <h1>Stanzify</h1>
    <form id="search-form">
      <label for="search-input">Search by title:</label>
      <input type="text" id="search-input" name="search-input">
      <button type="submit">Search</button>
    </form>
    <div id="search-results"></div>
    <script>
      const searchForm = document.getElementById("search-form");
      const searchInput = document.getElementById("search-input");
      const searchResults = document.getElementById("search-results");
      
      searchForm.addEventListener("submit", event => {
        event.preventDefault();
        searchResults.innerHTML = "";
        const query = searchInput.value.toLowerCase().trim();
        if (query === "") return;
        const xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function() {
          if (this.readyState === XMLHttpRequest.DONE) {
            if (this.status === 200) {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(this.responseText, "text/html");
              const notes = htmlDoc.querySelectorAll(".note");
              let resultsHtml = "";
              notes.forEach(note => {
                const title = note.querySelector("h2").textContent.toLowerCase();
                if (title.includes(query)) {
                  resultsHtml += note.outerHTML;
                }
              });
              if (resultsHtml === "") {
                resultsHtml = "<p>No results found.</p>";
              }
              searchResults.innerHTML = resultsHtml;
            } else {
              searchResults.innerHTML = "<p>Search failed.</p>";
            }
          }
        };
        xhr.open("GET", "poetry_notes/");
        xhr.send();
      });
    </script>
  </body>
</html>
